<html>
  <head>
    <meta charset="utf-8">
    <title>MazeGame</title>
    <meta name="description" content="level 4 of exploring code module game">

    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <!-- <script src="https://unpkg.com/aframe-extras@6.1.0/dist/aframe-extras.loaders.min.js"></script> -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
   
    <script>

      let coffee = false;
      let beenToGate = false;
      // let 
      AFRAME.registerComponent('foo', {
        init: function() {
          this.el.addEventListener('collide', function(e) {
            let id = e.detail.body.el.getAttribute('id');
            console.log(id)
            // console.log('Player has collided with ', e.detail.body.el);
            // e.detail.target.el; // Original entity (playerEl).
            // e.detail.body.el; // Other entity, which playerEl touched.
            // e.detail.contact; // Stats about the collision (CANNON.ContactEquation).
            // e.detail.contact.ni; // Normal (direction) of the collision (CANNON.Vec3).

            if (id == 'gate1' || id == 'gate2') {

              if (coffee === true) {
              window.location.href = 'maze.html';
              } else {
                beenToGate = true;
                document.getElementById('text').innerHTML = 'The gates to the maze seems to be closed.. Maybe there\'s someone around here that can help'
                document.querySelector('#instructions').style = 'display: block;';
                console.log('get coffee first')
              }
            }

            if (id === 'bench') {
              if (beenToGate) {
              console.log('found the man')
              document.querySelector('#instructions2').style = 'display: block;';
              } else {
                document.getElementById('text').innerHTML = 'Good morning to you, what a loveley day'
                document.querySelector('#instructions').style = 'display: block;';

              }
            }
            
          });
        }
      })

    </script>
    <style>
      .info-box {
        z-index: 100; 
        position: relative; 
        background-color: yellow;
        width: 300px; 
        margin: 0 auto; 
        padding: 20px; 
        text-align: center; 
        border-radius: 10px; 
        box-shadow: 2px 2px 2px gray;
      }

      #start {
        top: 30%; 
      }

      #camera-container {
        position: absolute; 
        top:0; 
        left: 0; 
        z-index: 100;
      }

      #instructions {
        display: none;
        top: 25%;
      }
      #instructions2 {
        display: none;
        top: 25%;
      }
    </style>
</head>
<body>

  <div id='start' class="info-box">

    <h1>Level 4</h1>

    <p>You are on your way to the Medium. But in order to get there you need 
      to go through Pleasantville's Enchanting Corn Maze..</p>
      
      <button type="button" id="start-button">Ok</button>
    </div>
    
    <div id='instructions' class="info-box">
      <p id="text">The gates to the maze seems to be closed.. Lets go see if we can get some help to open them..</p>
      <button type="button" id="ok-button">Ok</button>

  </div>
  
  <div id="instructions2" class="info-box">
    <p>"Before you can go into the maze you must get me a cup of coffee"</p>
    <button type="button" id="start-camera">Start</button>

  </div>

  <div id="camera-container">
    <div id="label-container"></div>
    <div id="webcam-container"></div>
  </div>

  <!-- ="debug: true" -->
  <a-scene physics>
    <a-sky color="#007FF0"></a-sky>
    <a-plane static-body rotation="-90 0 0" position="0 0 -4" width="15" height="15" color="darkgreen"></a-plane>

    <!-- ASSETS -->
    <a-assets>
        <img src="assets/door.png" id="door">
        <img src="assets/corn.jpg" id="asset_wall">
        <img src="assets/exit3.png" id="asset_entrance">
        <!-- <a-asset-item src="assets/Sitting-Idle.fbx" id="asset_character"></a-asset-item> -->
    </a-assets>
    


    <!-- Camera Entity -->
    <a-entity id="camera" position="0 1.6 0" rotation="0 0 0">
      <a-entity id="camera" camera look-controls wasd-controls kinematic-body foo>
      </a-entity>
      <a-entity text="text: Time;size:.07;height:0.001" material="color:red" position="0 0 0" id="board"></a-entity>
      <a-entity text="text:Test ;size:0.1;height:0.001" material="color:#f4ff61" position="-0.6 0 -1" id="red"></a-entity>
    </a-entity>

    <!-- CORN STALKS -->
    <a-gltf-model
        src="assets/cornstalks.glb"
        position="-3  0 -8.5"
        rotation=' 0 90 0'
        animation-mixer="clip: *;"
        scale="0.14 0.14 0.14"
        shadow
        static-body
        id='man'
      ></a-gltf-model>
      <a-gltf-model
        src="assets/cornstalks.glb"
        position="-5.5  0 -8.5"
        rotation=' 0 90 0'
        animation-mixer="clip: *;"
        scale="0.14 0.14 0.14"
        shadow
      ></a-gltf-model>
      <a-gltf-model
      src="assets/cornstalks.glb"
      position="0  0 -8.5"
      rotation=' 0 90 0'
      animation-mixer="clip: *;"
      scale="0.14 0.14 0.14"
      shadow
      ></a-gltf-model>
      <a-gltf-model
        src="assets/cornstalks.glb"
        position="2.5  0 -8.5"
        rotation=' 0 90 0'
        animation-mixer="clip: *;"
        scale="0.14 0.14 0.14"
        shadow
      ></a-gltf-model>
    <a-gltf-model
        src="assets/cornstalks.glb"
        position="7  0 -8.5"
        rotation=' 0 90 0'
        animation-mixer="clip: *;"
        scale="0.14 0.14 0.14"
        shadow
      ></a-gltf-model>

      <!-- BENCH -->
        <a-gltf-model
        position="-4 -1 0"
          src="assets/bench.glb"
          rotation="0 140 0"
          animation-mixer="clip: *;"
          scale="1 1 1"
          shadow
          static-body
          id="bench"
        ></a-gltf-model>

        <a-gltf-model
        position="-4 0.1 0"
          src="assets/man.glb"
          rotation="0 140 0"
          animation-mixer="clip: *;"
          scale="0.5 0.5 0.5"
          shadow
          static-body
          id="bench"
        ></a-gltf-model>

    <!-- 
        <a-box
        static-body
        shadow
        color="red"
        position="1 1 -4"></a-box> -->

        <!-- TREES -->
    <!-- <a-gltf-model
      src="assets/tree.glb"
      position="0 0.7 4"
      animation-mixer="clip: *;"
      shadow
      static-body
      id="tree"
      scale="2 2 2"
    ></a-gltf-model> -->
    <a-gltf-model
      src="assets/tree.glb"
      position="-3 0.5 0"
      animation-mixer="clip: *;"
      static-body
      shadow
      id="tree"
      scale="3 3 3"
    ></a-gltf-model>
    <a-gltf-model
      src="assets/tree.glb"
      position="5 0.7 -1"
      animation-mixer="clip: *;"
      id="tree"
      shadow
      static-body
      scale="1 1 1" 
    ></a-gltf-model>


    <!-- GATES -->
      <a-gltf-model
      src="assets/gate.glb"
      position="3.1 -1.6 -7.5"
      rotation="0 -10 0"
      animation-mixer="clip: *;"
      id="gate1"
      shadow
      static-body
      scale="1.5 1.5 1.5" 
    ></a-gltf-model>

    <a-gltf-model
    src="assets/gate.glb"
    position="4.1 -1.6 -7.2"
    animation-mixer="clip: *;"
    id="gate2"
    shadow
    static-body
    scale="1.5 1.5 1.5" 
  ></a-gltf-model>

    <!-- Using the asset management system. -->
    <a-image  static-body src="#asset_entrance" position="5 0.3 -8.7" width="2" height="7" id='entrance'></a-image>
    <a-box static-body position="0 0 -9" width="15" height="4" depth="0.5" material="src:#asset_wall; repeat: 7 2"></a-box>


    <!-- <a-box dynamic-body position="0 1 -2" color="#4CC3D9" width="1" height="1" depth="1"></a-box> -->


  </a-scene>

    <script src='src/intro.js'></script>

      <!-- TEACHABLE -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
    <script src="src/teachable.js"></script>
</body>
</html>


<!-- <html>
  <html>
    <head>
      
      <script src="https://unpkg.com/aframe@latest"></script>

    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
      <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
       -->
     <!-- <script src="libs/aframe.js"></script>   -->
    <!-- <script src="libs/aframe-extras.js"></script> 
    <script src="libs/aframe-text-component.min.js"></script>  -->
    <!--<script src="libs/lz-string.min.js"></script>  
    <script src="libs/aframe-bmfont-text-component.js"></script>   
    <script src="src/game.js"></script>
    <script src="src/common.js"></script>  
    <script src="https://cdn.jsdelivr.net/npm/aframe-glow@1.0.1/dist/aframe-glow-component.js"></script> -->
<!-- 
    </head>
    <body>

    <div style="z-index: 100;">
      <button type="button" id="start-camera">Start</button>
      <div id="webcam-container"></div>
      <div id="label-container"></div>
  <h1>heading test</h1>
</div>

  <div style="z-index: 1; margin-top: 100px;">
      <a-scene physics id='intro'>
        <a-sky color="green"></a-sky>
        <a-plane
          src="https://cdn.aframe.io/a-painter/images/floor.jpg"
          rotation="-90 0 0"
          width="30"
          height="30"
          static-body
        ></a-plane>
        
        <a-gltf-model
          src="assets/scene.glb"
          position="0 0 -4"
          animation-mixer="clip: *;"
          scale="0.01 0.01 0.01"
          shadow
          static-body
          id='man'
        ></a-gltf-model>

        <a-box color="red" position="2 1 -3" static-body id="box"></a-box>

        <a-gltf-model
          src="assets/tree.glb"
          position="0 0.7 -8"
          animation-mixer="clip: *;"
          shadow
          static-body
          
          scale="2 2 2"
        ></a-gltf-model>
        <a-gltf-model
          src="assets/tree.glb"
          position="-3 0.5 0"
          animation-mixer="clip: *;"
          static-body
          shadow
          scale="3 3 3"
        ></a-gltf-model>
        <a-gltf-model
          src="assets/tree.glb"
          position="4 0.7 -1"
          animation-mixer="clip: *;"
          shadow
          static-body
          scale="3 3 3" 
        ></a-gltf-model>-->
<!-- 
        <a-image
          position="0 2 -15"
          src="https://cdn.glitch.com/62ad2894-2a60-4a5c-9b61-b7bb6a5a87e1%2Fpattern-Frame%2089.png?v=1620827921646"
        ></a-image>
        <a-image
          style="z-index: -1"
          position="2 2 -15"
          src="https://cdn.glitch.com/62ad2894-2a60-4a5c-9b61-b7bb6a5a87e1%2Fpattern-Frame%2086.png?v=1620807808945"
        ></a-image>

        <a-image
          position="-15 2 -8"
          src="https://cdn.glitch.com/62ad2894-2a60-4a5c-9b61-b7bb6a5a87e1%2Fpattern-Frame%2088.png?v=1620827929818"
          rotation="0 90 0"
        ></a-image>
        <a-image
          position="-15 2 -10"
          src="https://cdn.glitch.com/62ad2894-2a60-4a5c-9b61-b7bb6a5a87e1%2Fpattern-Frame%2087.png?v=1620827932986"
          rotation="0 90 0"
        ></a-image> 

        <a-entity id="camera" position="0 1.6 0" kinematic-body> -->
          <!-- Camera Entity -->
          <!-- <a-entity id="camera" camera look-controls wasd-controls kinematic-body foo></a-entity>
        </a-entity>
      </a-scene>

    </div>

    <script>
      var cam = document.getElementById('camera');

      AFRAME.registerComponent('foo', {
        init: function() {
          this.el.addEventListener('collide', function(e) {
            console.log('Player has collided with ', e.detail.body.el);
            e.detail.target.el; // Original entity (playerEl).
            e.detail.body.el; // Other entity, which playerEl touched.
            e.detail.contact; // Stats about the collision (CANNON.ContactEquation).
            e.detail.contact.ni; // Normal (direction) of the collision (CANNON.Vec3).
          });
        }
      })

      cam.addEventListener('collide', function (e) {
        let id = e.detail.body.el.getAttribute('id')
        console.log('collided with ' + id)
      }

      </script> -->
    <!-- TEACHABLE -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
    <script src="src/teachable.js"></script>

    </body>
  </html>
</html> -->