<html>
  <head>
    <meta charset="utf-8">
    <title>MazeGame</title>
    <meta name="description" content="level 4 of exploring code module game">

    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <!-- <script src="https://unpkg.com/aframe-extras@6.1.0/dist/aframe-extras.loaders.min.js"></script> -->
    <!-- <script src="libs/aframe-extras.js"></script>     Aframe-extras.js(v2.6.1) Library -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-physics-system/v4.0.1/dist/aframe-physics-system.min.js"></script>
  
   
    <script>

      let coffee = false;
      let beenToGate = false;
      // let 
      AFRAME.registerComponent('foo', {
        init: function() {
          this.el.addEventListener('collide', function(e) {
            let id = e.detail.body.el.getAttribute('id');
            console.log(id)
            // console.log('Player has collided with ', e.detail.body.el);
            // e.detail.target.el; // Original entity (playerEl).
            // e.detail.body.el; // Other entity, which playerEl touched.
            // e.detail.contact; // Stats about the collision (CANNON.ContactEquation).
            // e.detail.contact.ni; // Normal (direction) of the collision (CANNON.Vec3).

            if (id == 'gate1' || id == 'gate2') {

              if (coffee === true) {
              window.location.href = 'maze.html';
              } else {
                beenToGate = true;
                document.getElementById('text').innerHTML = 'The gates to the maze seems to be closed.. Maybe there\'s someone around here that can help'
                document.querySelector('#instructions').style = 'display: block;';
                console.log('get coffee first')
              }
            }

            if (id === 'bench') {
              if (beenToGate) {
              console.log('found the man')
              document.querySelector('#instructions2').style = 'display: block;';
              } else {
                document.getElementById('text').innerHTML = 'Good morning to you, what a loveley day'
                document.querySelector('#instructions').style = 'display: block;';

              }
            }
            
          });
        }
      })

    </script>
    <style>
      .info-box {
        z-index: 100; 
        position: relative; 
        background-color: yellow;
        width: 300px; 
        margin: 0 auto; 
        padding: 20px; 
        text-align: center; 
        border-radius: 10px; 
        box-shadow: 2px 2px 2px gray;
      }

      #start {
        top: 30%; 
      }

      #camera-container {
        position: absolute; 
        top:0; 
        left: 0; 
        z-index: 100;
      }

      #instructions {
        display: none;
        top: 25%;
      }
      #instructions2 {
        display: none;
        top: 25%;
      }
    </style>
</head>
<body>
<!-- 
  <div id='start' class="info-box">

    <h1>Level 4</h1>

    <p>You are on your way to the Medium. But in order to get there you need 
      to go through Pleasantville's Enchanting Corn Maze..</p>
      
      <button type="button" id="start-button">Ok</button>
    </div>
    
    <div id='instructions' class="info-box">
      <p id="text">The gates to the maze seems to be closed.. Lets go see if we can get some help to open them..</p>
      <button type="button" id="ok-button">Ok</button>

  </div>
  
  <div id="instructions2" class="info-box">
    <p>"Before you can go into the maze you must get me a cup of coffee"</p>
    <button type="button" id="start-camera">Start</button>

  </div> -->

  <div id="camera-container">
    <div id="label-container"></div>
    <div id="webcam-container"></div>
  </div>

  <!-- ="debug: true" -->
  <a-scene physics="debug: true" fog="type: linear; color: #AAB; near: 0; far:14;">
    <a-sky color="#007FF0"></a-sky>
    <a-plane static-body rotation="-90 0 0" position="0 0 -4" width="20" height="40" material="src:#asset_ground; repeat: 2 4"></a-plane>

    <!-- ASSETS -->
    <a-assets>
        <img src="assets/door.png" id="door">
        <img src="assets/corn.jpg" id="asset_wall">
        <img src="assets/exit3.png" id="asset_entrance">
        <img src="assets/grass.jpg" id="asset_ground">
        <a-asset-item src="assets/house2.glb" id="asset_house"></a-asset-item>
    </a-assets>
    
    <!-- Camera Entity -->
    <a-entity id="camera" position="0 1.6 0" rotation="0 0 0">
      <a-entity id="camera" camera look-controls="pointerLockEnabled: true" wasd-controls kinematic-body foo>
        <!-- <a-entity text="value: Time;" material="color:red" position="0 0.3 0" id="board"></a-entity> -->
        <a-entity text="value:Test; align: center;"  material="color:black" position="-0.6 0 -1" id="red"></a-entity>
        <a-entity cursor="fuse: true; fuseTimeout: 500"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.01; radiusOuter: 0.02"
                  material="color:#20639B; shader: flat">
                </a-entity>
      </a-entity>
    </a-entity>

    <a-cylinder position="1 0.75 -3" radius="0.5" height="0.05" color="#FFC65D" shadow rotation="90 0 0" animation="property: rotation; dur: 5000; dir: alternate; loop: true; easing: linear; to:  0  0 360;"></a-cylinder>


    <a-gltf-model
        static-body
        src="assets/house2.glb"
        position="-3  0.7 -20"
        rotation=' 0 0 0'
        animation-mixer="clip: *;"
        scale="0.014 0.014 0.014"
        shadow
      ></a-gltf-model>

    <a-box static-body position="0 0 8" width="15" height="4" depth="0.5" material="src:#asset_wall; repeat: 7 2"></a-box> -->

    <!-- CORN STALKS -->
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="-3 0 7"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
            static-body
            id='man'
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="-5.5 0 7"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="0 0 7"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="2.5  0 7"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="7 0 7"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="-3 0 5"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
            static-body
            id='man'
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="-5.5 0 5"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="0 0 5"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="2.5 0 5"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
            ></a-gltf-model>
        <a-gltf-model
            src="assets/cornstalks.glb"
            position="7 0 5"
            rotation=' 0 90 0'
            animation-mixer="clip: *;"
            scale="0.14 0.14 0.14"
            shadow
        ></a-gltf-model>

        <!-- TREES -->
    <a-gltf-model
      src="assets/tree.glb"
      position="0 0.7 4"
      animation-mixer="clip: *;"
      shadow
      static-body
      id="tree"
      scale="2 2 2"
    ></a-gltf-model>
    <a-gltf-model
      src="assets/tree.glb"
      position="-3 0.5 0"
      animation-mixer="clip: *;"
      static-body
      shadow
      id="tree"
      scale="3 3 3"
    ></a-gltf-model>
    <a-gltf-model
      src="assets/tree.glb"
      position="5 0.7 -1"
      animation-mixer="clip: *;"
      id="tree"
      shadow
      static-body
      scale="1 1 1" 
    ></a-gltf-model>


    <!-- GATES -->
    <a-gltf-model src="assets/gate.glb" animation-mixer="clip: *;" id="gate1" shadow="" static-body="" scale="1.5 1.5 1.5" gltf-model="" velocity="" rotation="0 10 0" position="3.2 -1.6 9"></a-gltf-model>
    <a-gltf-model src="assets/gate.glb" animation-mixer="clip: *;" id="gate2" shadow="" static-body="" scale="1.5 1.5 1.5" gltf-model="" velocity="" position="3.8 -1.6 8.7"></a-gltf-model>

  </a-scene>

    <script src='src/intro.js'></script>

      <!-- TEACHABLE -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
    <script src="src/teachable.js"></script>
</body>
</html>

